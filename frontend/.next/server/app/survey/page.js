(()=>{var e={};e.id=5869,e.ids=[5869],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9156:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(29492).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11825:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/frontend/src/app/survey/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/frontend/src/app/survey/page.tsx","default")},13457:(e,t,s)=>{"use strict";s.d(t,{T:()=>a});var r=s(28625),n=s(64996),i=s(37284);let a=n.forwardRef(({className:e,...t},s)=>(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));a.displayName="Textarea"},15748:(e,t,s)=>{"use strict";s.d(t,{Ci:()=>u,Fw:()=>m,JY:()=>l,Ql:()=>c,UD:()=>x,Ut:()=>d,gJ:()=>o,mt:()=>p});var r=s(21386);s(72557);let n="org_health_surveys_v1",i=e=>[],a=(e,t)=>{};async function o(e){let t=i(n),s={id:(0,r.A)(),objective:e.objective,questions:e.questions,deployedAt:new Date().toISOString(),status:"active",submissionCount:0,optOutCount:0};return t.unshift(s),a(n,t),s}async function l(){return i(n).sort((e,t)=>new Date(t.deployedAt).getTime()-new Date(e.deployedAt).getTime())}async function d(){return(await l()).find(e=>"active"===e.status)||null}async function u(e){let t=i(n),s=t.findIndex(t=>t.id===e);-1!==s&&(t[s].submissionCount++,a(n,t))}async function c(e){let t=i(n),s=t.findIndex(t=>t.id===e);-1!==s&&(t[s].optOutCount||(t[s].optOutCount=0),t[s].optOutCount++,a(n,t))}async function m(e){let t=i(n),s=t.findIndex(t=>t.id===e);-1!==s&&"active"===t[s].status&&(t[s].status="closed",a(n,t))}async function p(e,t){let s=i(n),r=s.findIndex(t=>t.id===e);-1!==r&&(s[r].summary=t,a(n,s))}async function x(e,t,s){let r=i(n),o=r.findIndex(t=>t.id===e);-1!==o&&(r[o].coachingRecommendations=t,r[o].summary=s,a(n,r))}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20601:(e,t,s)=>{Promise.resolve().then(s.bind(s,62043))},27957:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d});var r=s(5853),n=s(60554),i=s(30708),a=s.n(i),o=s(8067),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d={children:["",{children:["survey",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,11825)),"/home/user/studio/frontend/src/app/survey/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,94638))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,25347)),"/home/user/studio/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,92192,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,82137,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,48358,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,94638))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,u=["/home/user/studio/frontend/src/app/survey/page.tsx"],c={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/survey/page",pathname:"/survey",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},48382:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(29492).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},54413:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(29492).A)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]])},62043:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(28625),n=s(64996),i=s(4715),a=s(10565),o=s(81045),l=s(3062),d=s(13457),u=s(85091),c=s(15748),m=s(78656),p=s(27031),x=s(54413),h=s(48382),f=s(9156),v=s(93948),y=s.n(v),b=s(11107);function j(){let[e,t]=(0,n.useState)(null),[s,v]=(0,n.useState)(!0),[j,g]=(0,n.useState)({}),[w,N]=(0,n.useState)(!1),[k,A]=(0,n.useState)(!1),[C,P]=(0,n.useState)(null),{toast:q}=(0,u.dj)(),S=(0,b.useRouter)(),_=(e,t)=>{g(s=>({...s,[e]:t}))},M=async()=>{if(e){if(e.questions.filter(e=>!j[e.id]).length>0)return void q({variant:"destructive",title:"Incomplete Survey",description:`Please answer all ${e.questions.length} questions before submitting.`});N(!0);try{await (0,c.Ci)(e.id);let t=Math.floor(1e5+9e5*Math.random()).toString(),s=`${t.substring(0,3)}-${t.substring(3)}`;P(s),A(!0),q({variant:"success",title:"Survey Submitted",description:"Thank you for your anonymous feedback."})}catch(e){console.error("Failed to submit survey",e),q({variant:"destructive",title:"Submission Failed"})}finally{N(!1)}}},R=async()=>{if(e)try{await (0,c.Ql)(e.id),q({title:"Response Logged",description:"You have opted out of this survey."}),S.push("/")}catch(e){console.error("Failed to log opt-out",e),q({variant:"destructive",title:"Operation Failed"})}},T=!!e&&e.questions.every(e=>j[e.id]&&""!==j[e.id].trim());return s?(0,r.jsx)("div",{className:"flex h-screen w-screen items-center justify-center p-4 bg-muted",children:(0,r.jsx)(l.E,{className:"h-96 w-full max-w-2xl"})}):k?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:(0,r.jsxs)(a.Zp,{className:"w-full max-w-2xl text-center",children:[(0,r.jsxs)(a.aR,{children:[(0,r.jsx)(m.A,{className:"mx-auto h-16 w-16 text-green-500 mb-4"}),(0,r.jsx)(a.ZB,{className:"text-2xl",children:"Thank You!"})]}),(0,r.jsxs)(a.Wu,{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Your anonymous response has been submitted successfully."}),C&&(0,r.jsxs)("div",{className:"p-4 bg-muted border rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your Submission Number:"}),(0,r.jsx)("p",{className:"text-2xl font-bold font-mono tracking-widest text-primary",children:C}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Please save this number for your records if you need to reference this submission."})]})]}),(0,r.jsx)(a.wL,{className:"justify-center",children:(0,r.jsx)(i.$,{asChild:!0,variant:"outline",children:(0,r.jsxs)(y(),{href:"/",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Go Back"]})})})]})}):e?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:(0,r.jsxs)(a.Zp,{className:"w-full max-w-2xl",children:[(0,r.jsxs)(a.aR,{children:[(0,r.jsx)(a.ZB,{className:"text-2xl",children:"Anonymous Survey"}),(0,r.jsx)(a.BT,{children:e.objective})]}),(0,r.jsx)(a.Wu,{className:"space-y-6",children:e.questions.map((e,t)=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(o.J,{htmlFor:e.id,className:"font-semibold",children:["Question ",t+1]}),(0,r.jsx)("p",{className:"text-sm text-foreground",children:e.questionText}),(0,r.jsx)(d.T,{id:e.id,placeholder:"Your anonymous response...",value:j[e.id]||"",onChange:t=>_(e.id,t.target.value),rows:3})]},e.id))}),(0,r.jsxs)(a.wL,{className:"flex justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsx)(i.$,{asChild:!0,variant:"ghost",className:"text-muted-foreground hover:text-destructive",children:(0,r.jsx)("button",{onClick:R,children:"I don't wish to participate"})})}),(0,r.jsxs)(i.$,{onClick:M,disabled:w||!T,children:[w?(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Submit Anonymously"]})]})]})}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:(0,r.jsxs)(a.Zp,{className:"w-full max-w-2xl text-center",children:[(0,r.jsxs)(a.aR,{children:[(0,r.jsx)(x.A,{className:"mx-auto h-16 w-16 text-muted-foreground mb-4"}),(0,r.jsx)(a.ZB,{children:"No Active Survey"})]}),(0,r.jsx)(a.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"There are currently no active surveys available. Please check back later."})}),(0,r.jsx)(a.wL,{className:"justify-center",children:(0,r.jsx)(i.$,{asChild:!0,variant:"outline",children:(0,r.jsxs)(y(),{href:"/",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Go Back"]})})})]})})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},75498:(e,t,s)=>{"use strict";s.d(t,{b:()=>o});var r=s(64996),n=s(55498),i=s(28625),a=r.forwardRef((e,t)=>(0,i.jsx)(n.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var o=a},77598:e=>{"use strict";e.exports=require("node:crypto")},78656:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(29492).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},79551:e=>{"use strict";e.exports=require("url")},81045:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var r=s(28625),n=s(64996),i=s(75498),a=s(44714),o=s(37284);let l=(0,a.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef(({className:e,...t},s)=>(0,r.jsx)(i.b,{ref:s,className:(0,o.cn)(l(),e),...t}));d.displayName=i.b.displayName},84153:(e,t,s)=>{Promise.resolve().then(s.bind(s,11825))}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9683,4967,1808,2047,1933],()=>s(27957));module.exports=r})();