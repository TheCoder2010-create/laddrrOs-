{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/main-sidebar.tsx"],"sourcesContent":["\n\nimport { useState, useEffect, useCallback } from 'react';\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuGroup,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Sidebar, SidebarHeader, SidebarContent, SidebarFooter, SidebarMenu, SidebarMenuItem, SidebarMenuSub, SidebarMenuSubItem, SidebarMenuSubButton, useSidebar, SidebarMenuButton } from '@/components/ui/sidebar';\nimport { LogOut, User, BarChart, Check, ListTodo, MessageSquare, BrainCircuit, MessagesSquare, FlaskConical, Handshake, Scale, HeartPulse } from 'lucide-react';\nimport type { Role } from '@/hooks/use-role';\nimport { useRole } from '@/hooks/use-role';\nimport { getAllFeedback, getOneOnOneHistory, getPracticeScenariosForUser } from '@/services/feedback-service';\nimport { getNominationForUser as getInterviewerNominationForUser } from '@/services/interviewer-lab-service';\nimport { getNominationForUser as getLeadershipNominationForUser, getNominationsForMentor } from '@/services/leadership-service';\nimport { Badge } from '@/components/ui/badge';\nimport { roleUserMapping } from '@/lib/role-mapping';\nimport { cn } from '@/lib/utils';\nimport { LeadershipIcon } from './ui/leadership-icon';\nimport { InterviewerLabIcon } from './ui/interviewer-lab-icon';\nimport { OneOnOneIcon } from './ui/one-on-one-icon';\n\n\ninterface MainSidebarProps {\n  currentRole: Role;\n  onSwitchRole: (role: Role | null) => void;\n}\n\nexport default function MainSidebar({ currentRole, onSwitchRole }: MainSidebarProps) {\n  const { availableRoles } = useRole();\n  const currentUser = roleUserMapping[currentRole] || { name: 'User', fallback: 'U', imageHint: 'person', role: currentRole };\n  const currentUserName = currentUser.name;\n  const pathname = usePathname();\n  const [messageCount, setMessageCount] = useState(0);\n  const [oneOnOneCount, setOneOnOneCount] = useState(0);\n  const [coachingCount, setCoachingCount] = useState(0);\n  const [netsCount, setNetsCount] = useState(0);\n  const [isInterviewerNominee, setIsInterviewerNominee] = useState(false);\n  const [isLeadershipNominee, setIsLeadershipNominee] = useState(false);\n  const [isMentor, setIsMentor] = useState(false);\n  const [openSubMenus, setOpenSubMenus] = useState<string[]>([]);\n  const { state: sidebarState } = useSidebar();\n  \n\n  const fetchData = useCallback(async () => {\n    if (!currentRole) return;\n    try {\n      // Fetch all data sources in parallel\n      const [feedback, history, assignedNets, interviewerNomination, leadershipNomination, mentorNominations] = await Promise.all([\n        getAllFeedback(),\n        getOneOnOneHistory(),\n        getPracticeScenariosForUser(currentRole),\n        getInterviewerNominationForUser(currentRole),\n        getLeadershipNominationForUser(currentRole),\n        getNominationsForMentor(currentRole),\n      ]);\n\n      // --- Calculate 1-on-1 Notifications (Critical Insights) ---\n      let criticalInsightsCount = 0;\n      const actionableInsightStatuses: string[] = [];\n      if (currentRole === 'Employee') actionableInsightStatuses.push('pending_employee_acknowledgement');\n      if (currentRole === 'Team Lead') {\n          actionableInsightStatuses.push('open'); \n          actionableInsightStatuses.push('pending_supervisor_retry');\n      }\n      if (currentRole === 'AM') actionableInsightStatuses.push('pending_am_review');\n      if (currentRole === 'Manager') actionableInsightStatuses.push('pending_manager_review');\n      if (currentRole === 'HR Head') {\n          actionableInsightStatuses.push('pending_hr_review');\n          actionableInsightStatuses.push('pending_final_hr_action');\n      }\n      \n      history.forEach(h => {\n          const insight = h.analysis.criticalCoachingInsight;\n          const isMyTurn = (h.supervisorName === currentUserName && (insight?.status === 'open' || insight?.status === 'pending_supervisor_retry')) ||\n                           (h.employeeName === currentUserName && insight?.status === 'pending_employee_acknowledgement') ||\n                           (insight && insight.status && actionableInsightStatuses.includes(insight.status) && h.assignedTo?.includes(currentRole));\n\n          if (insight && insight.status && isMyTurn && actionableInsightStatuses.includes(insight.status)) {\n              criticalInsightsCount++;\n          }\n      });\n      setOneOnOneCount(criticalInsightsCount);\n\n      // --- Calculate General Messages (non-Nets related) ---\n      let generalMessageCount = 0;\n      feedback.forEach(f => {\n        const isAssignedToMe = f.assignedTo?.includes(currentRole as any);\n        if (!isAssignedToMe || f.trackingId?.startsWith('NETS-')) return; // Exclude Nets notifications\n\n        const isPendingAck = f.status === 'Pending Acknowledgement';\n        const isIdentifiedAck = f.status === 'Pending Employee Acknowledgment' && f.submittedBy === currentRole;\n        if (isPendingAck || isIdentifiedAck) {\n            generalMessageCount++;\n        }\n      });\n      setMessageCount(generalMessageCount);\n\n      // --- Calculate Nets Notifications ---\n      setNetsCount(assignedNets.length);\n\n\n      // --- Calculate Coaching Notifications ---\n      let devCount = 0;\n      history.forEach(h => {\n        if (h.supervisorName === currentUserName) {\n          devCount += h.analysis.coachingRecommendations.filter(rec => rec.status === 'pending').length;\n        }\n      });\n      const recStatusesToCount: string[] = [];\n      if (currentRole === 'AM') recStatusesToCount.push('pending_am_review');\n      if (currentRole === 'Manager') recStatusesToCount.push('pending_manager_acknowledgement');\n      if (recStatusesToCount.length > 0) {\n        history.forEach(h => {\n            devCount += h.analysis.coachingRecommendations.filter(rec => rec.status && recStatusesToCount.includes(rec.status)).length;\n        });\n      }\n      setCoachingCount(devCount);\n\n      // --- Set Nomination Statuses ---\n      setIsInterviewerNominee(!!interviewerNomination);\n      setIsLeadershipNominee(!!leadershipNomination);\n      setIsMentor(mentorNominations.length > 0);\n\n    } catch (error) {\n      console.error(\"Failed to fetch sidebar data\", error);\n      setMessageCount(0);\n      setOneOnOneCount(0);\n      setCoachingCount(0);\n      setNetsCount(0);\n      setIsInterviewerNominee(false);\n      setIsLeadershipNominee(false);\n      setIsMentor(false);\n    }\n  }, [currentRole, currentUserName]);\n\n  // Menu items are now defined within the component body to access state\n  const menuItems = [\n    { href: '/', icon: <BarChart className=\"text-blue-500\"/>, label: 'Dashboard' },\n    { href: '/1-on-1', icon: <OneOnOneIcon className=\"text-green-500 size-5 flex-shrink-0\"/>, label: '1-on-1', badge: oneOnOneCount > 0 ? oneOnOneCount : null, badgeVariant: 'destructive' as const },\n    { href: '/nets', icon: <MessagesSquare className=\"text-indigo-500\"/>, label: 'Nets', badge: netsCount > 0 ? netsCount : null, badgeVariant: 'destructive' as const },\n    ...(['Team Lead', 'AM', 'Manager', 'HR Head'].includes(currentRole) ? [{ href: '/coaching', icon: <BrainCircuit className=\"text-purple-500\"/>, label: 'Coaching', badge: coachingCount > 0 ? coachingCount : null, badgeVariant: 'secondary' as const }] : []),\n    ...(isMentor ? [{ href: '/mentorship', icon: <Handshake className=\"text-cyan-500\"/>, label: 'Mentorship' }] : []),\n    ...(['Manager'].includes(currentRole) ? [{ href: '/goals', icon: <Scale className=\"text-rose-500\"/>, label: 'Goals' }] : []),\n    ...(['HR Head'].includes(currentRole) ? [{ href: '/org-health', icon: <HeartPulse className=\"text-pink-500\"/>, label: 'Org Health' }] : []),\n    ...(['Manager', 'HR Head'].includes(currentRole) ? [{ \n        href: '/managers-lab', \n        icon: <FlaskConical className=\"text-orange-500\"/>, \n        label: \"Manager's Lab\",\n        children: [\n           { href: '/interviewer-lab', icon: <InterviewerLabIcon className=\"text-teal-500 size-4\"/>, label: \"Interviewer Lab\" },\n           { href: '/leadership', icon: <LeadershipIcon className=\"text-red-500 size-4\"/>, label: \"Leadership\" }\n        ]\n    }] : []),\n    ...(!['Manager', 'HR Head'].includes(currentRole) && isInterviewerNominee ? [{ href: '/interviewer-lab', icon: <InterviewerLabIcon className=\"text-teal-500\"/>, label: \"Interviewer Lab\" }] : []),\n    ...(!['Manager', 'HR Head'].includes(currentRole) && isLeadershipNominee ? [{ href: '/leadership', icon: <LeadershipIcon className=\"text-red-500 size-4\"/>, label: \"Leadership\" }] : []),\n    { href: '/messages', icon: <MessageSquare className=\"text-yellow-500\"/>, label: 'Messages', badge: messageCount > 0 ? messageCount : null, badgeVariant: 'destructive' as const },\n  ];\n\n  useEffect(() => {\n    const activeSubMenu = menuItems.find(item => \n      item.children?.some(child => pathname.startsWith(child.href))\n    );\n    if (activeSubMenu && !openSubMenus.includes(activeSubMenu.label)) {\n      setOpenSubMenus(prev => [...prev, activeSubMenu.label]);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pathname]);\n\n  useEffect(() => {\n    if (sidebarState === 'collapsed') {\n      setOpenSubMenus([]);\n    }\n  }, [sidebarState]);\n\n  useEffect(() => {\n    fetchData();\n\n    const handleDataUpdate = () => {\n        fetchData();\n    };\n\n    window.addEventListener('storage', handleDataUpdate);\n    window.addEventListener('feedbackUpdated', handleDataUpdate);\n\n    return () => {\n        window.removeEventListener('storage', handleDataUpdate);\n        window.removeEventListener('feedbackUpdated', handleDataUpdate);\n    };\n  }, [fetchData]);\n  \n  const toggleSubMenu = (label: string) => {\n    setOpenSubMenus(prev => prev.includes(label) ? prev.filter(l => l !== label) : [...prev, label]);\n  }\n\n  const renderMenuItem = (item: any) => {\n     if (item.children) {\n      const isParentActive = item.children.some((child: any) => pathname.startsWith(child.href));\n      const isSubMenuOpen = openSubMenus.includes(item.label);\n\n      return (\n        <SidebarMenuItem key={item.label} className=\"flex flex-col\">\n            <SidebarMenuButton \n                asChild={false}\n                isActive={isParentActive && !isSubMenuOpen}\n                onClick={() => toggleSubMenu(item.label)}\n                className=\"w-full\"\n            >\n              <div className=\"flex justify-between items-center w-full\">\n                <div className=\"flex items-center gap-2\">\n                    {item.icon}\n                    <span>{item.label}</span>\n                </div>\n              </div>\n            </SidebarMenuButton>\n            {isSubMenuOpen && (\n              <SidebarMenuSub className=\"mt-1\">\n                {item.children.map((child: any) => (\n                  <SidebarMenuSubItem key={child.href}>\n                     <Link href={child.href} passHref>\n                      <SidebarMenuSubButton asChild isActive={pathname.startsWith(child.href)}>\n                          <div className=\"flex items-center gap-2\">\n                             {child.icon}\n                             <span>{child.label}</span>\n                          </div>\n                      </SidebarMenuSubButton>\n                    </Link>\n                  </SidebarMenuSubItem>\n                ))}\n              </SidebarMenuSub>\n            )}\n        </SidebarMenuItem>\n      )\n    }\n\n    return (\n     <SidebarMenuItem key={item.href}>\n        <Link href={item.href} passHref>\n          <SidebarMenuButton asChild isActive={pathname === item.href}>\n            <div className=\"flex justify-between items-center w-full\">\n              <div className=\"flex items-center gap-2\">\n                {item.icon}\n                <span>{item.label}</span>\n              </div>\n              {item.badge ? (\n                  <Badge variant={item.badgeVariant} className=\"h-6 w-6 flex items-center justify-center p-0 rounded-full\">\n                  {item.badge}\n                </Badge>\n              ) : null}\n            </div>\n          </SidebarMenuButton>\n        </Link>\n      </SidebarMenuItem>\n    );\n  }\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"p-4\">\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <div className=\"flex items-center gap-3 cursor-pointer\">\n              <Avatar className=\"h-12 w-12\">\n                <AvatarImage src={`https://placehold.co/100x100.png`} alt={currentUser.name} data-ai-hint={`${currentUser.imageHint} avatar`} />\n                <AvatarFallback>{currentUser.fallback}</AvatarFallback>\n              </Avatar>\n              <div className=\"flex flex-col items-start\">\n                <span className=\"font-semibold text-lg text-sidebar-foreground\">{currentUser.name}</span>\n                <span className=\"text-sm text-muted-foreground\">{currentRole}</span>\n              </div>\n            </div>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent className=\"w-56 ml-4\">\n            <DropdownMenuLabel>{currentUser.name}</DropdownMenuLabel>\n            <DropdownMenuSeparator />\n            <DropdownMenuGroup>\n                <DropdownMenuLabel>Switch Role</DropdownMenuLabel>\n                {availableRoles.map(role => (\n                    <DropdownMenuItem key={role} onClick={() => onSwitchRole(role)}>\n                         {currentRole === role ? (\n                            <Check className=\"mr-2 h-4 w-4 text-green-500\" />\n                        ) : (\n                            <span className=\"mr-2 h-4 w-4\" />\n                        )}\n                        <span>{role}</span>\n                    </DropdownMenuItem>\n                ))}\n            </DropdownMenuGroup>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem onClick={() => onSwitchRole(null)}>\n              <LogOut className=\"mr-2 h-4 w-4 text-destructive\" />\n              <span>Log out</span>\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </SidebarHeader>\n      <SidebarContent className=\"p-2\">\n        <SidebarMenu>\n          {menuItems.map(renderMenuItem)}\n        </SidebarMenu>\n      </SidebarContent>\n      <SidebarFooter className=\"p-2\">\n        <SidebarMenu>\n          <SidebarMenuItem>\n            <SidebarMenuButton onClick={() => onSwitchRole(null)}>\n              <LogOut className=\"text-destructive\"/>\n              <span>Log out</span>\n            </SidebarMenuButton>\n          </SidebarMenuItem>\n        </SidebarMenu>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n\n\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 778, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/dashboard.tsx"],"sourcesContent":["\nimport type { Role } from '@/hooks/use-role';\nimport ManagerDashboard from './dashboards/manager-dashboard';\nimport LeadDashboard from './dashboards/lead-dashboard';\nimport EmployeeDashboard from './dashboards/employee-dashboard';\nimport HRHeadDashboard from './dashboards/hr-head-dashboard';\nimport AmDashboard from './dashboards/am-dashboard';\n\ninterface DashboardProps {\n  role: Role;\n}\n\nexport default function Dashboard({ role }: DashboardProps) {\n  const renderDashboard = () => {\n    switch (role) {\n      case 'Manager':\n        return <ManagerDashboard />;\n      case 'Team Lead':\n        return <LeadDashboard />;\n      case 'AM':\n        return <AmDashboard />;\n      case 'Employee':\n        return <EmployeeDashboard />;\n      case 'HR Head':\n        return <HRHeadDashboard />;\n      default:\n        return <div>Invalid Role</div>;\n    }\n  };\n\n  return (\n    <div className=\"p-4 md:p-8 space-y-8\">\n      {renderDashboard()}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;;;;;;;AAMe,SAAS,UAAU,EAAE,IAAI,EAAkB;IACxD,MAAM,kBAAkB;QACtB,OAAQ;YACN,KAAK;gBACH,qBAAO,8OAAC,oKAAA,CAAA,UAAgB;;;;;YAC1B,KAAK;gBACH,qBAAO,8OAAC,iKAAA,CAAA,UAAa;;;;;YACvB,KAAK;gBACH,qBAAO,8OAAC,+JAAA,CAAA,UAAW;;;;;YACrB,KAAK;gBACH,qBAAO,8OAAC,qKAAA,CAAA,UAAiB;;;;;YAC3B,KAAK;gBACH,qBAAO,8OAAC,uKAAA,CAAA,UAAe;;;;;YACzB;gBACE,qBAAO,8OAAC;8BAAI;;;;;;QAChB;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACZ;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 851, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/theme-toggle.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { useTheme } from \"next-themes\"\nimport { Moon, Sun } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { cn } from \"@/lib/utils\"\n\nexport function ThemeToggle() {\n  const { theme, setTheme } = useTheme()\n  const [isMounted, setIsMounted] = React.useState(false)\n\n  React.useEffect(() => {\n    setIsMounted(true)\n  }, [])\n\n  const toggleTheme = () => {\n    setTheme(theme === \"light\" ? \"dark\" : \"light\")\n  }\n\n  if (!isMounted) {\n    return (\n        <Button variant=\"ghost\" size=\"icon\" disabled>\n             <Sun className=\"h-[1.2rem] w-[1.2rem]\" />\n        </Button>\n    )\n  }\n\n  return (\n    <Button \n      variant=\"ghost\" \n      size=\"icon\" \n      onClick={toggleTheme} \n      aria-label=\"Toggle theme\"\n      className={cn(\n        \"bg-transparent hover:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0\",\n        theme === 'light' \n          ? \"text-yellow-500 drop-shadow-[0_0_8px_rgba(234,179,8,0.8)]\" \n          : \"text-white drop-shadow-[0_0_8px_rgba(255,255,255,0.8)]\"\n      )}\n    >\n      <Sun className=\"h-[1.2rem] w-[1.2rem] block dark:hidden\" />\n      <Moon className=\"h-[1.2rem] w-[1.2rem] hidden dark:block\" />\n    </Button>\n  )\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAAA;AAEA;AACA;AAPA;;;;;;;AASO,SAAS;IACd,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,CAAA,GAAA,gJAAA,CAAA,WAAQ,AAAD;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAc,AAAD,EAAE;IAEjD,CAAA,GAAA,qMAAA,CAAA,YAAe,AAAD,EAAE;QACd,aAAa;IACf,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,SAAS,UAAU,UAAU,SAAS;IACxC;IAEA,IAAI,CAAC,WAAW;QACd,qBACI,8OAAC,8IAAA,CAAA,SAAM;YAAC,SAAQ;YAAQ,MAAK;YAAO,QAAQ;sBACvC,cAAA,8OAAC,gMAAA,CAAA,MAAG;gBAAC,WAAU;;;;;;;;;;;IAG1B;IAEA,qBACE,8OAAC,8IAAA,CAAA,SAAM;QACL,SAAQ;QACR,MAAK;QACL,SAAS;QACT,cAAW;QACX,WAAW,CAAA,GAAA,+HAAA,CAAA,KAAE,AAAD,EACV,wFACA,UAAU,UACN,8DACA;;0BAGN,8OAAC,gMAAA,CAAA,MAAG;gBAAC,WAAU;;;;;;0BACf,8OAAC,kMAAA,CAAA,OAAI;gBAAC,WAAU;;;;;;;;;;;;AAGtB","debugId":null}},
    {"offset": {"line": 929, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/header.tsx"],"sourcesContent":["import Link from 'next/link';\nimport { ThemeToggle } from './theme-toggle';\nimport { ShieldCheck } from 'lucide-react';\n\nexport default function Header() {\n  return (\n    <header className=\"sticky top-0 z-40 w-full border-b bg-background\">\n      <div className=\"container flex h-16 items-center space-x-4 sm:justify-between sm:space-x-0\">\n        <div className=\"flex gap-6 md:gap-10\">\n          <Link href=\"/\" className=\"flex items-center space-x-2\">\n            <ShieldCheck className=\"h-6 w-6 text-primary\" />\n            <span className=\"inline-block font-bold text-xl\">Laddrr</span>\n          </Link>\n        </div>\n        <div className=\"flex flex-1 items-center justify-end space-x-4\">\n          <nav className=\"flex items-center space-x-1\">\n            <ThemeToggle />\n          </nav>\n        </div>\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEe,SAAS;IACtB,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;wBAAI,WAAU;;0CACvB,8OAAC,oNAAA,CAAA,cAAW;gCAAC,WAAU;;;;;;0CACvB,8OAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;;;;;;;8BAGrD,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,iJAAA,CAAA,cAAW;;;;;;;;;;;;;;;;;;;;;;;;;;AAMxB","debugId":null}},
    {"offset": {"line": 1015, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/dashboard-layout.tsx"],"sourcesContent":["import type { ReactNode } from 'react';\nimport type { Role } from '@/hooks/use-role';\nimport { SidebarProvider, SidebarInset } from '@/components/ui/sidebar';\nimport MainSidebar from '@/components/main-sidebar';\nimport Dashboard from '@/components/dashboard';\nimport Header from './header';\n\ninterface DashboardLayoutProps {\n  role: Role;\n  onSwitchRole: (role: Role | null) => void;\n  children?: ReactNode;\n}\n\nexport default function DashboardLayout({ role, onSwitchRole, children }: DashboardLayoutProps) {\n  return (\n    <SidebarProvider>\n      <MainSidebar currentRole={role} onSwitchRole={onSwitchRole} />\n      <SidebarInset>\n        <Header />\n        {children || <Dashboard role={role} />}\n      </SidebarInset>\n    </SidebarProvider>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;;;;AAQe,SAAS,gBAAgB,EAAE,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAwB;IAC5F,qBACE,8OAAC,+IAAA,CAAA,kBAAe;;0BACd,8OAAC,iJAAA,CAAA,UAAW;gBAAC,aAAa;gBAAM,cAAc;;;;;;0BAC9C,8OAAC,+IAAA,CAAA,eAAY;;kCACX,8OAAC,wIAAA,CAAA,UAAM;;;;;oBACN,0BAAY,8OAAC,2IAAA,CAAA,UAAS;wBAAC,MAAM;;;;;;;;;;;;;;;;;;AAItC","debugId":null}},
    {"offset": {"line": 1072, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/frontend/src/components/simulation-arena.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useState, useTransition, useRef, useEffect, useCallback } from 'react';\nimport { useRole } from '@/hooks/use-role';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Bot, User, Send, Loader2, ArrowLeft, Lightbulb } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { runNetsConversation } from '../../backend/src/ai/flows/nets-flow';\nimport type { NetsConversationInput, NetsMessage, NetsInitialInput } from '../../backend/src/ai/schemas/nets-schemas';\nimport { useToast } from '@/hooks/use-toast';\nimport { generateNetsNudge } from '../../backend/src/ai/flows/generate-nets-nudge-flow';\n\n\nconst Avatar = ({ icon }: { icon: React.ReactNode }) => (\n    <div className=\"h-8 w-8 rounded-full bg-secondary flex items-center justify-center flex-shrink-0\">\n        {icon}\n    </div>\n);\n\n\nexport default function SimulationArena({\n    initialConfig,\n    onExit,\n    arenaTitle = \"Practice Arena\",\n}: {\n    initialConfig: NetsInitialInput,\n    onExit: (messages?: NetsMessage[]) => void,\n    arenaTitle?: string\n}) {\n    const [isPending, startTransition] = useTransition();\n    const [isGettingNudge, startNudgeTransition] = useTransition();\n    const [messages, setMessages] = useState<NetsMessage[]>([]);\n    const [userInput, setUserInput] = useState('');\n    const { toast } = useToast();\n    const scrollAreaRef = useRef<HTMLDivElement>(null);\n\n    const handleExit = () => {\n        // Pass the final message history back to the parent component\n        onExit(messages.filter(m => m.role !== 'system'));\n    };\n\n    useEffect(() => {\n        const startSimulation = () => {\n            const initialSystemMessage: NetsMessage = {\n                role: 'system',\n                content: `Simulation started. The AI is playing the role of a ${initialConfig.persona}.`\n            };\n            const currentMessages = [initialSystemMessage];\n            setMessages(currentMessages);\n\n            startTransition(async () => {\n                try {\n                    const input: NetsConversationInput = {\n                        ...initialConfig,\n                        history: [], // History is empty for the first turn\n                    };\n                    const aiResponse = await runNetsConversation(input);\n                    setMessages(prev => [...prev, aiResponse]);\n                } catch (error) {\n                    console.error(\"AI simulation failed on start\", error);\n                    toast({ variant: 'destructive', title: \"Simulation Error\", description: \"The AI could not start the conversation. Please try again.\" });\n                    onExit(); // Exit if the start fails\n                }\n            });\n        };\n\n        startSimulation();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [initialConfig, toast]);\n    \n    useEffect(() => {\n        if (scrollAreaRef.current) {\n            scrollAreaRef.current.scrollTo({ top: scrollAreaRef.current.scrollHeight, behavior: 'smooth' });\n        }\n    }, [messages]);\n\n    const handleSendMessage = () => {\n        if (!userInput.trim()) return;\n\n        const newUserMessage: NetsMessage = { role: 'user', content: userInput };\n        const currentMessages = [...messages, newUserMessage];\n        setMessages(currentMessages);\n        setUserInput('');\n\n        startTransition(async () => {\n            try {\n                const input: NetsConversationInput = {\n                    ...initialConfig,\n                    history: currentMessages.filter(m => m.role !== 'system'),\n                };\n                const aiResponse = await runNetsConversation(input);\n                setMessages(prev => [...prev, aiResponse]);\n            } catch (error) {\n                console.error(\"AI simulation failed\", error);\n                toast({ variant: 'destructive', title: \"Simulation Error\", description: \"The AI could not respond. Please try again.\" });\n                setMessages(prev => prev.slice(0, -1));\n            }\n        });\n    };\n    \n    const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n        if (e.key === 'Enter' && !e.shiftKey) {\n            e.preventDefault();\n            if (!isPending) {\n                handleSendMessage();\n            }\n        }\n    };\n    \n    const handleGetNudge = () => {\n        startNudgeTransition(async () => {\n            try {\n                const input: NetsConversationInput = {\n                    ...initialConfig,\n                    history: messages.filter(m => m.role !== 'system'),\n                };\n                const result = await generateNetsNudge(input);\n                toast({\n                    title: \"Coach's Nudge\",\n                    description: result.nudge,\n                    duration: 8000,\n                });\n            } catch (error) {\n                console.error(\"Failed to get nudge\", error);\n                toast({ variant: 'destructive', title: \"Nudge Failed\", description: \"Could not get a hint at this time.\" });\n            }\n        });\n    };\n\n    return (\n        <Card className=\"w-full max-w-4xl mx-auto shadow-2xl shadow-primary/10\">\n            <CardHeader>\n                 <div className=\"flex justify-between items-center\">\n                    <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                        {arenaTitle}\n                    </CardTitle>\n                     <Button variant=\"ghost\" onClick={handleExit}>\n                        <ArrowLeft className=\"mr-2\" /> End Session\n                    </Button>\n                </div>\n                <CardDescription>\n                    You are in a simulation with a <span className=\"font-semibold text-primary\">{initialConfig.persona}</span>.\n                    The scenario is: <span className=\"font-semibold text-primary\">{initialConfig.scenario}</span>.\n                </CardDescription>\n            </CardHeader>\n            <CardContent>\n                <ScrollArea className=\"h-[50vh] w-full border rounded-lg p-4 space-y-4\" ref={scrollAreaRef}>\n                    {messages.map((msg, index) => (\n                        <div key={index} className={cn(\"flex items-start gap-3\", msg.role === 'user' ? 'justify-end' : 'justify-start')}>\n                             {msg.role === 'model' && <Avatar icon={<Bot className=\"text-primary\" />} />}\n                             {msg.role === 'system' ? (\n                                <div className=\"text-center text-xs text-muted-foreground italic w-full py-4\">{msg.content}</div>\n                             ) : (\n                                <div className={cn(\"max-w-[75%] rounded-lg px-4 py-2\", msg.role === 'user' ? 'bg-primary text-primary-foreground' : 'bg-muted')}>\n                                    <p className=\"text-sm whitespace-pre-wrap\">{msg.content}</p>\n                                </div>\n                             )}\n                            {msg.role === 'user' && <Avatar icon={<User />} />}\n                        </div>\n                    ))}\n                    {isPending && messages.length > 0 && (\n                        <div className=\"flex items-start gap-3 justify-start\">\n                            <Avatar icon={<Bot className=\"text-primary\" />} />\n                            <div className=\"bg-muted rounded-lg px-4 py-3\">\n                                <Loader2 className=\"h-5 w-5 animate-spin text-muted-foreground\" />\n                            </div>\n                        </div>\n                    )}\n                </ScrollArea>\n            </CardContent>\n            <CardFooter>\n                 <div className=\"flex w-full items-center gap-2 relative\">\n                    <Button variant=\"ghost\" size=\"icon\" onClick={handleGetNudge} disabled={isGettingNudge || isPending} className=\"absolute left-2 top-1/2 -translate-y-1/2\">\n                         {isGettingNudge ? <Loader2 className=\"animate-spin text-yellow-400\" /> : <Lightbulb className=\"text-yellow-400\" />}\n                    </Button>\n                    <Textarea\n                        value={userInput}\n                        onChange={(e) => setUserInput(e.target.value)}\n                        onKeyDown={handleKeyDown}\n                        placeholder=\"Type your response here...\"\n                        className=\"pl-14 pr-12\"\n                        rows={1}\n                        disabled={isPending}\n                    />\n                    <Button\n                        size=\"icon\"\n                        onClick={handleSendMessage}\n                        disabled={isPending || !userInput.trim()}\n                        className=\"absolute right-2\"\n                    >\n                        <Send />\n                    </Button>\n                </div>\n            </CardFooter>\n        </Card>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}